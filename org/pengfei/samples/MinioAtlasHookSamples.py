from org.pengfei.minio.MinioAtlasHook import MinioAtlasHook

minio_end_point = 'minio.lab.sspcloud.fr'
minio_access_key = '39YU64HL1W1L0D0QT9BS'
minio_secret_key = 'qa9MK5rLZIRz2SVR09FK7N7f5KdHAv46oMMqUtG+'
minio_token = 'eyJhbGciOiJIUzUxMiIsInR5cCI6IkpXVCJ9.eyJhY2Nlc3NLZXkiOiIzOVlVNjRITDFXMUwwRDBRVDlCUyIsImFjciI6IjAiLCJhbGxvd2VkLW9yaWdpbnMiOlsiKiJdLCJhdWQiOlsib255eGlhIiwiYWNjb3VudCJdLCJhdXRoX3RpbWUiOjE2MDI4MzI0NDQsImF6cCI6Im9ueXhpYSIsImVtYWlsIjoibGl1LnBlbmdmZWlAaG90bWFpbC5mciIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJleHAiOiIxNjAyODc1NjQ0IiwiZmFtaWx5X25hbWUiOiJMaXUiLCJnaXZlbl9uYW1lIjoiUGVuZ2ZlaSIsImlhdCI6MTYwMjgzMjQ1NCwiaXNzIjoiaHR0cHM6Ly9hdXRoLmxhYi5zc3BjbG91ZC5mci9hdXRoL3JlYWxtcy9zc3BjbG91ZCIsImp0aSI6IjQwYmJjYTMzLWUxZWUtNGY2MS04ZDQ2LWFkNzZmZGFhNTQ5YyIsIm5hbWUiOiJQZW5nZmVpIExpdSIsIm5vbmNlIjoiMzVmODRhYzEtYTBkZS00ZDVjLThmZTItY2IzNWE5ZmU0YzI2IiwicG9saWN5IjoiIiwicHJlZmVycmVkX3VzZXJuYW1lIjoicGVuZ2ZlaSIsInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJBdGxhc19yb2xlX2FkbWluIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJvcGVuaWQgcHJvZmlsZSBlbWFpbCIsInNlc3Npb25fc3RhdGUiOiIwNmNjYTQwNC1iMjMxLTRkOTItYjZiOC02NzhmN2QyN2M5NDQiLCJzdWIiOiI0NzM0OTEyOC00YTRjLTQyMjYtYTViMS02ODA4MDFhZjVhMmIiLCJ0eXAiOiJCZWFyZXIifQ._Az_21pQM5w2rMQRiSEaiuDXvzn5jXSmpvv78w6YNyBv19S4D-Wz8iaSed2ilbL2tD1-eISIbL1ZBtERoo0I-Q'
atlas_hostname = "localhost"
atlas_port = 21000
atlas_login = "admin"
atlas_pwd = "admin"

minio_hook = MinioAtlasHook(minio_end_point,minio_access_key,minio_secret_key,minio_token,atlas_hostname,atlas_port,atlas_login,atlas_pwd)

path = "pengfei"
path1 = "pengfei/pengfei_test"
path_long="pengfei/pengfei_test/data_science/deep_learning/data_set"
path2 = "pengfei/pengfei_test/Demo2_ Retail_WEB_SITE_BI.json"

# Alias of FilesystemSpec.info
meta_data = minio_hook.get_entity_meta_data(path)
meta_data1 = minio_hook.get_entity_meta_data(path1)
meta_data2 = minio_hook.get_entity_meta_data(path2)
long_meta=minio_hook.get_entity_meta_data(path_long)
print(long_meta)
# print(content)
print(meta_data)
print(meta_data1)
print(meta_data2)

path_class = minio_hook.get_type_from_path(path)
path_class1 = minio_hook.get_class_from_path(path1)
path_class2 = minio_hook.get_class_from_path(path2)

print(path_class)
print(path_class1)
print(path_class2)

path_type = minio_hook.get_type_from_path(path)
path_type1 = minio_hook.get_type_from_path(path1)
path_type2 = minio_hook.get_type_from_path(path2)

print(path_type)
print(path_type1)
print(path_type2)

# minio_hook.create_atlas_bucket(meta_data,"added by minio hook")
minio_hook.create_atlas_ps_dir(meta_data1,"added by minio hook")
minio_hook.create_atlas_object(meta_data2,"added by minio hook")