from org.pengfei.minio.MinioAtlasHook import MinioAtlasHook

minio_end_point = 'minio.lab.sspcloud.fr'
minio_access_key = 'GJGQUDFQGXHCEFJDA4GR'
minio_secret_key = 'Avm8QuIHscxPGOtUBuaY9L7Lx01cdHOuBTAHuQ4a'
minio_token = 'eyJhbGciOiJIUzUxMiIsInR5cCI6IkpXVCJ9.eyJhY2Nlc3NLZXkiOiJHSkdRVURGUUdYSENFRkpEQTRHUiIsImFjciI6IjAiLCJhbGxvd2VkLW9yaWdpbnMiOlsiKiJdLCJhdWQiOlsib255eGlhIiwiYWNjb3VudCJdLCJhdXRoX3RpbWUiOjE2MDI4NTA0MTAsImF6cCI6Im9ueXhpYSIsImVtYWlsIjoibGl1LnBlbmdmZWlAaG90bWFpbC5mciIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJleHAiOiIxNjAyODkzNjEwIiwiZmFtaWx5X25hbWUiOiJMaXUiLCJnaXZlbl9uYW1lIjoiUGVuZ2ZlaSIsImlhdCI6MTYwMjg1MTAxNywiaXNzIjoiaHR0cHM6Ly9hdXRoLmxhYi5zc3BjbG91ZC5mci9hdXRoL3JlYWxtcy9zc3BjbG91ZCIsImp0aSI6ImQ4Y2U3ZGFlLWNkMzItNGUzZC1iMmU0LTFkZTkxYmU2YjQyYSIsIm5hbWUiOiJQZW5nZmVpIExpdSIsIm5vbmNlIjoiZDNjODU1NDctODA5Ny00M2UyLTg0MWUtM2U3N2FiMjA3MzEyIiwicG9saWN5IjoiIiwicHJlZmVycmVkX3VzZXJuYW1lIjoicGVuZ2ZlaSIsInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJBdGxhc19yb2xlX2FkbWluIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJvcGVuaWQgcHJvZmlsZSBlbWFpbCIsInNlc3Npb25fc3RhdGUiOiI0YjUyYTAyMy1hNmI3LTRkZmItYjJhZC0xOWI3ZTY1M2JhMzEiLCJzdWIiOiI0NzM0OTEyOC00YTRjLTQyMjYtYTViMS02ODA4MDFhZjVhMmIiLCJ0eXAiOiJCZWFyZXIifQ.3JLZqrtkW-U9QPGNC2aCWFjKamkQSaVQJ26qX9o981oQePJYtZlpfEXSv0b_RHM4UZM-tT_CR7U9bvAXolKCHw'

atlas_hostname = "localhost"
atlas_port = 21000
atlas_login = "admin"
atlas_pwd = "admin"

minio_hook = MinioAtlasHook(minio_end_point,minio_access_key,minio_secret_key,minio_token,atlas_hostname,atlas_port,atlas_login,atlas_pwd)

path = "pengfei"
path1 = "pengfei/pengfei_test/for_demo/"
path_long="pengfei/pengfei_test/data_science/deep_learning/data_set"
path2 = "pengfei/pengfei_test/for_demo/iris.txt"

# Alias of FilesystemSpec.info
meta_data = minio_hook.get_entity_meta_data(path)
meta_data1 = minio_hook.get_entity_meta_data(path1)
meta_data2 = minio_hook.get_entity_meta_data(path2)
long_meta=minio_hook.get_entity_meta_data(path_long)
print(long_meta)
# print(content)
print(meta_data)
print(meta_data1)
print(meta_data2)

path_class = minio_hook.get_type_from_path(path)
path_class1 = minio_hook.get_class_from_path(path1)
path_class2 = minio_hook.get_class_from_path(path2)

print(path_class)
print(path_class1)
print(path_class2)

path_type = minio_hook.get_type_from_path(path)
path_type1 = minio_hook.get_type_from_path(path1)
path_type2 = minio_hook.get_type_from_path(path2)

print(path_type)
print(path_type1)
print(path_type2)

# minio_hook.create_atlas_bucket(meta_data,"added by minio hook")
#minio_hook.create_atlas_ps_dir(meta_data1,"added by minio hook")
minio_hook.create_atlas_object(meta_data2,"added by minio hook")